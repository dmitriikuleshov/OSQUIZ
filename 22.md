### Планирование процессов: введение

**Планирование процессов** — это фундаментальный механизм операционных систем (ОС), определяющий, как процессорное время распределяется между процессами. Этот механизм особенно важен для интерактивных систем, где пользователь ожидает быстрого отклика. В таких системах приоритет отдается задачам, которые требуют минимального времени ожидания, без ущерба для производительности других процессов.

#### Основные цели планирования процессов:

1. **Минимизация времени отклика**: критически важно для интерактивных приложений.
2. **Справедливость**: равный доступ к ресурсам для всех процессов.
3. **Максимизация пропускной способности**: обработка большего количества задач за минимальное время.
4. **Обеспечение предсказуемости**: выполнение процессов в соответствии с установленными приоритетами или долями процессорного времени.
5. **Гибкость**: способность адаптироваться к различным рабочим нагрузкам.

---

### Особенности планирования в интерактивных системах

Интерактивные системы (например, Windows, Linux, macOS) предназначены для обработки пользовательских запросов в реальном времени. Они характеризуются многозадачностью, где процессы могут быть интерактивными (взаимодействие с пользователем) или фоновыми.

#### Ключевые особенности:

1. **Многозадачность**: обеспечение работы нескольких процессов одновременно.
2. **Гибкость управления приоритетами**: возможность выделять больше ресурсов процессам, связанным с действиями пользователя.
3. **Низкое время отклика**: критический параметр для обеспечения удобства работы пользователя.
4. **Динамическое перераспределение ресурсов**: процессорное время перераспределяется в зависимости от приоритетов задач.

---

### Лотерейное планирование

**Лотерейное планирование** (Lottery Scheduling) — это вероятностный алгоритм планирования, который обеспечивает справедливое распределение процессорного времени между процессами.

#### Принципы работы:

1. Каждому процессу выдаются "билеты", где количество билетов соответствует доле процессорного времени, которое процесс может получить.
2. В каждый момент времени ОС случайным образом выбирает один из билетов, и процесс, которому принадлежит билет, получает доступ к процессору.
3. Процессы с большим количеством билетов имеют больше шансов быть выбраны, но шанс остается у всех процессов.

#### Преимущества:

1. **Справедливость**: процессы получают процессорное время пропорционально количеству билетов.
2. **Гибкость**: позволяет динамически изменять приоритеты, добавляя или убирая билеты.
3. **Простота реализации**: требует генерации случайных чисел и управления количеством билетов.

#### Недостатки:

1. **Непредсказуемость**: возможно, что процесс с меньшим количеством билетов будет выбран несколько раз подряд.
2. **Накладные расходы**: управление билетами и генерация случайных чисел увеличивают накладные расходы.

#### Пример:

-   Процессы: P1 (20 билетов), P2 (50 билетов), P3 (30 билетов).
-   Общий пул билетов: 100.
-   Вероятность выбора:
    -   P1: 20/100 = 20%.
    -   P2: 50/100 = 50%.
    -   P3: 30/100 = 30%.

**Применение**: лотерейное планирование подходит для систем, где требуется справедливое распределение процессорного времени между процессами с возможностью гибкой настройки приоритетов. Используется в экспериментальных ОС, таких как Mach.

---

### Справедливое планирование (Fair Scheduling)

**Справедливое планирование** (Fair Share Scheduling) — это метод, при котором процессорное время делится между группами пользователей или процессами таким образом, чтобы каждая группа получила свою "справедливую" долю ресурсов.

#### Принципы работы:

1. Ресурсы распределяются между группами или процессами на основе их долей, заданных администратором.
2. Процессы, использующие больше своей доли, замедляются, чтобы другие могли использовать свою долю.
3. Механизм гарантирует, что ресурсы распределяются справедливо, даже если некоторые процессы более требовательны.

#### Преимущества:

1. **Равномерное распределение**: предотвращает доминирование одних процессов над другими.
2. **Гарантия справедливости**: каждый процесс или группа получает строго определенную долю времени.
3. **Гибкость**: можно настроить доли для разных групп или пользователей.

#### Недостатки:

1. **Сложность реализации**: требуется точное отслеживание использования ресурсов.
2. **Перегрузка системы**: при большом количестве пользователей или процессов могут увеличиваться накладные расходы.

#### Пример:

-   Пул процессорного времени: 100 мс.
-   Процессы: P1 (30%), P2 (50%), P3 (20%).
-   За каждый цикл процессы получают:
    -   P1: 30 мс.
    -   P2: 50 мс.
    -   P3: 20 мс.

**Применение**: справедливое планирование активно используется в серверных ОС, таких как Linux, для управления ресурсами в системах с несколькими пользователями.

---

### Гарантированное планирование (Guaranteed Scheduling)

**Гарантированное планирование** — это алгоритм, который гарантирует каждому процессу выполнение в соответствии с его заявленными потребностями.

#### Принципы работы:

1. Каждому процессу гарантируется определенная доля процессорного времени.
2. ОС отслеживает выполнение процессов и перераспределяет ресурсы, если процесс не получает своей доли.
3. Если процесс превышает свою долю, его выполнение замедляется.

#### Преимущества:

1. **Гарантия выполнения**: процесс получает ровно столько ресурсов, сколько ему было выделено.
2. **Справедливость**: каждый процесс выполняется в рамках своих ограничений.
3. **Простота понимания**: пользователи могут быть уверены в равном распределении ресурсов.

#### Недостатки:

1. **Сложность реализации**: требует точного отслеживания выполнения всех процессов.
2. **Неэффективность**: если процессы не используют свои гарантированные ресурсы, они могут простаивать.

#### Пример:

-   Доступно 100 мс процессорного времени.
-   Процессы: P1 (40%), P2 (30%), P3 (30%).
-   Каждый процесс гарантированно получает:
    -   P1: 40 мс.
    -   P2: 30 мс.
    -   P3: 30 мс.

**Применение**: гарантированное планирование используется в системах, где требуется строгий контроль выполнения задач, например, в реальном времени.

---

### Сравнение алгоритмов

| Алгоритм            | Преимущества                       | Недостатки                | Примеры ОС                |
| ------------------- | ---------------------------------- | ------------------------- | ------------------------- |
| **Лотерейное**      | Простота и гибкость                | Непредсказуемость         | Экспериментальные ОС      |
| **Справедливое**    | Равномерное распределение ресурсов | Сложность реализации      | Linux, серверные системы  |
| **Гарантированное** | Гарантия выполнения задач          | Высокие накладные расходы | Системы реального времени |

---

### Примеры реализации в реальных ОС

1. **Linux**:

    - Реализует **CFS (Completely Fair Scheduler)**, основанный на справедливом планировании.
    - Использует веса процессов для определения их доли процессорного времени.

2. **Windows**:

    - Реализует приоритетное планирование с динамическими приоритетами, что позволяет учитывать справедливость распределения ресурсов.

3. **Мобильные ОС (Android, iOS)**:
    - Используют гибридные подходы, включая справедливое и приоритетное планирование, чтобы обеспечить плавность интерфейса и стабильную работу фоновых задач.

---

### Заключение

Планирование процессов в интерактивных системах требует баланса между справедливостью, гибкостью и производительностью. Лотерейное планирование предоставляет вероятностный подход, справедливое планирование фокусируется на равномерном распределении ресурсов, а гарантированное обеспечивает выполнение задач в рамках заданных ограничений. Выбор алгоритма зависит от специфики системы, её требований и приоритетов задач.
